{%- comment -%}
  ============================================================
  SIGNATURE EDITORIAL HERO SECTION
  ============================================================
  A unique, magazine-style hero with asymmetric image tiles.
  
  Features:
  - Left: Headline, subheadline, rich text, dual CTAs
  - Right: 2-3 floating image tiles with subtle animations
  - Optional: Video background behind tiles
  - Mobile: Simplified stacked layout
  - Performance: GPU-accelerated CSS only, minimal JS
  
  For beginners: All text, images, and animations are
  customizable through the theme editor - no code needed.
{%- endcomment -%}

<section 
  class="signature-hero relative overflow-hidden {% if section.settings.enable_parallax %}parallax-container{% endif %}"
  data-section-id="{{ section.id }}"
  style="min-height: {{ section.settings.section_height }}vh;"
>
  {%- comment -%} 
    Optional video background 
    If enabled, plays behind the image tiles
  {%- endcomment -%}
  {%- if section.settings.background_video != blank -%}
    <div class="absolute inset-0 -z-10 opacity-{{ section.settings.video_opacity }}">
      <video
        class="h-full w-full object-cover"
        autoplay
        loop
        muted
        playsinline
        {% if section.settings.video_poster != blank %}
          poster="{{ section.settings.video_poster | image_url: width: 1920 }}"
        {% endif %}
      >
        <source src="{{ section.settings.background_video }}" type="video/mp4">
        Your browser does not support video backgrounds.
      </video>
      {%- comment -%} Overlay to ensure text readability {%- endcomment -%}
      <div class="absolute inset-0 bg-gradient-to-r from-[#F6F3EE] via-[#F6F3EE]/95 to-[#F6F3EE]/80"></div>
    </div>
  {%- endif -%}

  {%- comment -%} 
    Decorative background elements 
    Soft gradients for depth
  {%- endcomment -%}
  <div class="absolute inset-0 -z-20 pointer-events-none" aria-hidden="true">
    <div class="absolute top-0 left-0 h-96 w-96 rounded-full bg-[#9BB7A7]/10 blur-3xl transform -translate-x-1/2 -translate-y-1/2"></div>
    <div class="absolute bottom-0 right-0 h-96 w-96 rounded-full bg-[#C7A27C]/10 blur-3xl transform translate-x-1/3 translate-y-1/3"></div>
  </div>

  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16 sm:py-20 lg:py-28">
    <div class="grid lg:grid-cols-2 gap-12 lg:gap-16 items-center">
      
      {%- comment -%} 
        ==================== LEFT COLUMN: EDITORIAL CONTENT ====================
        Headline, subheadline, rich text body, and dual CTAs
      {%- endcomment -%}
      <div class="editorial-content {% if section.settings.enable_animations %}fade-in-up{% endif %}">
        
        {%- comment -%} Subheadline / Eyebrow {%- endcomment -%}
        {%- if section.settings.subheadline != blank -%}
          <p class="text-sm sm:text-base font-semibold tracking-wider uppercase text-[#9BB7A7] mb-4">
            {{ section.settings.subheadline }}
          </p>
        {%- endif -%}

        {%- comment -%} Main headline {%- endcomment -%}
        {%- if section.settings.headline != blank -%}
          <h1 class="font-serif text-4xl sm:text-5xl lg:text-6xl xl:text-7xl text-[#2B2B2B] tracking-tight leading-[1.1] mb-6">
            {{ section.settings.headline }}
          </h1>
        {%- endif -%}

        {%- comment -%} Rich text body {%- endcomment -%}
        {%- if section.settings.body_text != blank -%}
          <div class="prose prose-lg text-[#2B2B2B]/80 mb-8 max-w-xl">
            {{ section.settings.body_text }}
          </div>
        {%- endif -%}

        {%- comment -%} Dual CTAs {%- endcomment -%}
        <div class="flex flex-col sm:flex-row gap-4">
          {%- if section.settings.primary_cta_text != blank -%}
            <a 
              href="{{ section.settings.primary_cta_link | default: '#' }}"
              class="group inline-flex items-center justify-center gap-2 rounded-full bg-[#2F3E34] px-8 py-4 text-base font-semibold text-white shadow-lg hover:bg-[#25342B] hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-[#2F3E34] focus:ring-offset-2 transition-all duration-300"
            >
              {{ section.settings.primary_cta_text }}
              <svg class="h-5 w-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </a>
          {%- endif -%}

          {%- if section.settings.secondary_cta_text != blank -%}
            <a 
              href="{{ section.settings.secondary_cta_link | default: '#' }}"
              class="group inline-flex items-center justify-center gap-2 rounded-full border-2 border-[#2F3E34] bg-transparent px-8 py-4 text-base font-semibold text-[#2F3E34] hover:bg-[#2F3E34] hover:text-white focus:outline-none focus:ring-2 focus:ring-[#2F3E34] focus:ring-offset-2 transition-all duration-300"
            >
              {{ section.settings.secondary_cta_text }}
              <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </a>
          {%- endif -%}
        </div>
      </div>

      {%- comment -%} 
        ==================== RIGHT COLUMN: ASYMMETRIC IMAGE TILES ====================
        2-3 floating image tiles with hover effects
        Can use manual uploads or metaobjects
      {%- endcomment -%}
      <div class="editorial-tiles relative h-[500px] sm:h-[600px] lg:h-[650px] {% if section.settings.enable_animations %}fade-in{% endif %}">
        
        {%- comment -%} 
          TILE LAYOUT OPTIONS:
          - 2 tiles: Large + Small
          - 3 tiles: Large + Medium + Small (default)
          
          Positioning uses absolute positioning for asymmetric layout
          Mobile: Stack tiles vertically
        {%- endcomment -%}
        
        {%- assign tile_count = section.blocks.size | at_most: 3 -%}
        
        {%- for block in section.blocks limit: 3 -%}
          {%- liquid
            # Define tile positioning based on index
            # Tile 1: Large, top-left
            # Tile 2: Medium, bottom-right
            # Tile 3: Small, center-right
            
            case forloop.index
              when 1
                assign tile_class = "absolute top-0 left-0 w-3/5 h-3/5 z-20"
                assign tile_size = "large"
              when 2
                assign tile_class = "absolute bottom-0 right-0 w-2/5 h-2/5 z-10"
                assign tile_size = "medium"
              when 3
                assign tile_class = "absolute top-1/4 right-1/4 w-1/3 h-1/3 z-30"
                assign tile_size = "small"
            endcase
          -%}

          {%- comment -%} Individual image tile {%- endcomment -%}
          <div 
            class="image-tile {{ tile_class }} {% if section.settings.enable_animations %}tile-float{% endif %}"
            style="animation-delay: {{ forloop.index | times: 0.1 }}s;"
            {{ block.shopify_attributes }}
          >
            {%- comment -%} Tile wrapper with shadow and hover effect {%- endcomment -%}
            <div class="tile-wrapper relative h-full w-full overflow-hidden rounded-2xl shadow-2xl ring-1 ring-black/10 transform transition-all duration-500 hover:scale-105 hover:shadow-3xl hover:rotate-1 hover:-translate-y-2">
              
              {%- comment -%} Image {%- endcomment -%}
              {%- if block.settings.image != blank -%}
                <img
                  src="{{ block.settings.image | image_url: width: 800 }}"
                  alt="{{ block.settings.image.alt | default: section.settings.headline | escape }}"
                  class="h-full w-full object-cover transition-transform duration-700 hover:scale-110"
                  width="{{ block.settings.image.width }}"
                  height="{{ block.settings.image.height }}"
                  loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                >
              {%- else -%}
                {%- comment -%} Placeholder if no image {%- endcomment -%}
                <div class="h-full w-full bg-gradient-to-br from-[#E9E4D8] to-[#C7A27C]/30 flex items-center justify-center">
                  <span class="text-[#2B2B2B]/30 text-sm">Image {{ forloop.index }}</span>
                </div>
              {%- endif -%}

              {%- comment -%} Optional overlay with text {%- endcomment -%}
              {%- if block.settings.overlay_text != blank -%}
                <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent flex items-end p-6">
                  <p class="text-white font-medium text-sm sm:text-base drop-shadow-lg">
                    {{ block.settings.overlay_text }}
                  </p>
                </div>
              {%- endif -%}
            </div>
          </div>
        {%- endfor -%}

        {%- comment -%} Mobile fallback: Show tiles stacked {%- endcomment -%}
        <div class="lg:hidden flex flex-col gap-4">
          {%- for block in section.blocks limit: 3 -%}
            <div class="overflow-hidden rounded-2xl shadow-lg">
              {%- if block.settings.image != blank -%}
                <img
                  src="{{ block.settings.image | image_url: width: 800 }}"
                  alt="{{ block.settings.image.alt | default: section.settings.headline | escape }}"
                  class="w-full h-64 object-cover"
                  loading="lazy"
                >
              {%- endif -%}
            </div>
          {%- endfor -%}
        </div>
      </div>
    </div>
  </div>
</section>

{%- comment -%} 
  ==================== STYLES ====================
  Performance-focused: GPU-accelerated transforms only
  No heavy animations, no layout shifts
{%- endcomment -%}
<style>
  /* Base tile styling */
  .image-tile {
    /* Hide on mobile - we show stacked version instead */
    display: none;
  }

  /* Show asymmetric layout on desktop */
  @media (min-width: 1024px) {
    .image-tile {
      display: block;
    }
    
    /* Hide mobile stacked version on desktop */
    .editorial-tiles > .flex {
      display: none;
    }
  }

  /* Fade in animation (optional, performance-friendly) */
  {% if section.settings.enable_animations %}
    .fade-in-up {
      animation: fadeInUp 0.8s ease-out forwards;
      opacity: 0;
    }

    .fade-in {
      animation: fadeIn 1s ease-out forwards;
      opacity: 0;
    }

    /* Subtle floating animation for tiles */
    .tile-float {
      animation: tileFloat 6s ease-in-out infinite;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    /* GPU-accelerated floating (very subtle) */
    @keyframes tileFloat {
      0%, 100% {
        transform: translateY(0) translateX(0);
      }
      25% {
        transform: translateY(-8px) translateX(4px);
      }
      50% {
        transform: translateY(-4px) translateX(-4px);
      }
      75% {
        transform: translateY(-10px) translateX(2px);
      }
    }

    /* Stagger animation delays for tiles */
    .image-tile:nth-child(1) {
      animation-delay: 0.1s;
    }
    .image-tile:nth-child(2) {
      animation-delay: 0.2s;
    }
    .image-tile:nth-child(3) {
      animation-delay: 0.3s;
    }
  {% endif %}

  /* Enhanced hover shadow */
  .tile-wrapper:hover {
    box-shadow: 
      0 25px 50px -12px rgba(47, 62, 52, 0.25),
      0 0 0 1px rgba(155, 183, 167, 0.1);
  }

  /* Improve prose styling */
  .prose p {
    line-height: 1.75;
    margin-bottom: 1rem;
  }

  .prose strong {
    color: rgb(47 62 52);
    font-weight: 600;
  }

  /* Responsive tile sizing for medium screens */
  @media (min-width: 1024px) and (max-width: 1280px) {
    .editorial-tiles {
      height: 550px;
    }
  }

  /* Ensure video doesn't cause layout shift */
  .signature-hero video {
    will-change: auto;
  }

  /* Optimize animations for performance */
  .tile-float,
  .tile-wrapper {
    will-change: transform;
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .fade-in-up,
    .fade-in,
    .tile-float {
      animation: none !important;
      opacity: 1 !important;
    }

    .tile-wrapper:hover {
      transform: none !important;
    }
  }
</style>

{%- comment -%} 
  ==================== MINIMAL JAVASCRIPT ====================
  Optional: Only loads if animations are enabled
  Just for scroll-based reveals (very lightweight)
{%- endcomment -%}
{% if section.settings.enable_scroll_reveal %}
  <script>
    (function() {
      'use strict';

      // Simple intersection observer for scroll reveals
      // No heavy libraries, no jQuery
      function initScrollReveal() {
        const tiles = document.querySelectorAll('.image-tile');
        const content = document.querySelector('.editorial-content');
        
        if (!('IntersectionObserver' in window)) {
          // Browser doesn't support IntersectionObserver
          // Show everything immediately (graceful degradation)
          tiles.forEach(tile => tile.style.opacity = '1');
          if (content) content.style.opacity = '1';
          return;
        }

        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -10% 0px'
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              // Element is visible, trigger animation
              entry.target.style.opacity = '1';
              entry.target.style.transform = 'translateY(0)';
              // Stop observing after animation triggers (performance)
              observer.unobserve(entry.target);
            }
          });
        }, observerOptions);

        // Observe elements
        tiles.forEach(tile => observer.observe(tile));
        if (content) observer.observe(content);
      }

      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initScrollReveal);
      } else {
        initScrollReveal();
      }
    })();
  </script>
{% endif %}

{%- comment -%} 
  ==================== SCHEMA ====================
  All settings for theme customizer
  Beginners can control everything without code
{%- endcomment -%}
{% schema %}
{
  "name": "Editorial Hero",
  "class": "section signature-hero-section",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "section_height",
      "min": 60,
      "max": 100,
      "step": 5,
      "unit": "vh",
      "label": "Section height",
      "default": 85,
      "info": "Height as percentage of viewport (60-100)"
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "subheadline",
      "label": "Subheadline (Eyebrow)",
      "default": "New Collection",
      "info": "Small text above the headline"
    },
    {
      "type": "textarea",
      "id": "headline",
      "label": "Headline",
      "default": "Make calm a ritual.",
      "info": "Main heading - keep it short and impactful"
    },
    {
      "type": "richtext",
      "id": "body_text",
      "label": "Body text",
      "default": "<p>Curated small-farm teas, handcrafted accessories, and a pocket mindfulness guide—delivered monthly.</p>",
      "info": "Editorial description - supports bold, italic, links"
    },
    {
      "type": "header",
      "content": "Primary Call-to-Action"
    },
    {
      "type": "text",
      "id": "primary_cta_text",
      "label": "Button text",
      "default": "Shop The Collection"
    },
    {
      "type": "url",
      "id": "primary_cta_link",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Secondary Call-to-Action"
    },
    {
      "type": "text",
      "id": "secondary_cta_text",
      "label": "Button text",
      "default": "Watch Our Story"
    },
    {
      "type": "url",
      "id": "secondary_cta_link",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Video Background (Optional)"
    },
    {
      "type": "text",
      "id": "background_video",
      "label": "Video URL",
      "info": "Enter full URL to MP4 file (e.g., from Files in Shopify admin)"
    },
    {
      "type": "image_picker",
      "id": "video_poster",
      "label": "Video poster image",
      "info": "Shows while video loads"
    },
    {
      "type": "range",
      "id": "video_opacity",
      "min": 10,
      "max": 100,
      "step": 10,
      "unit": "%",
      "label": "Video opacity",
      "default": 40,
      "info": "Lower = more subtle background"
    },
    {
      "type": "header",
      "content": "Animations & Effects"
    },
    {
      "type": "checkbox",
      "id": "enable_animations",
      "label": "Enable entrance animations",
      "default": true,
      "info": "Fade in on load (respects prefers-reduced-motion)"
    },
    {
      "type": "checkbox",
      "id": "enable_scroll_reveal",
      "label": "Enable scroll reveal",
      "default": false,
      "info": "Animate on scroll (adds lightweight JavaScript)"
    },
    {
      "type": "checkbox",
      "id": "enable_parallax",
      "label": "Enable subtle parallax",
      "default": false,
      "info": "Experimental: Adds depth on scroll (GPU-accelerated)"
    }
  ],
  "blocks": [
    {
      "type": "image_tile",
      "name": "Image Tile",
      "limit": 3,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "Recommended: High quality, min 800x800px"
        },
        {
          "type": "text",
          "id": "overlay_text",
          "label": "Overlay text (optional)",
          "info": "Text appears at bottom of image on hover"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Editorial Hero",
      "settings": {
        "subheadline": "New Collection",
        "headline": "Make calm a ritual.",
        "body_text": "<p>Curated small-farm teas, handcrafted accessories, and a pocket mindfulness guide—delivered monthly.</p>",
        "primary_cta_text": "Shop The Collection",
        "secondary_cta_text": "Watch Our Story",
        "section_height": 85,
        "enable_animations": true
      },
      "blocks": [
        {
          "type": "image_tile"
        },
        {
          "type": "image_tile"
        },
        {
          "type": "image_tile"
        }
      ]
    }
  ]
}
{% endschema %}

